---
- name: 4.2.1.1 Ensure rsyslog is installed (Scored)
  package:
    name: rsyslog
    state: present
  when:
    - cis_syslog_installed | bool

- name: 4.2.1.2 Ensure rsyslog Service is enabled (Scored)
  service:
    name: rsyslog
    state: started
    enabled: yes
  when:
    - cis_rsyslog_enabled | bool

- name: 4.2.1.3 Ensure rsyslog default file permissions configured (Scored)
  lineinfile:
    path: /etc/rsyslog.d/filecreatemode.conf
    line: "$FileCreateMode 0640"
    regexp: '^\$FileCreateMode'
    create: yes
  notify:
    - restart rsyslog
  when:
    - cis_rsyslog_file_permissions_configured | bool
